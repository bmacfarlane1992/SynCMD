pro M_fileread, arch_dir=arch_dir, sim1=sim1, sim2=sim2, tag=tag, col1=col1, col2=col2, $
mag_glob=mag_glob, hist_up=hist_up,hist_down=hist_down, hist_int=hist_int, help=help
; 
; - - Procedure written to use read metallicity split star data filenames into required 
; - - file such that population synthesis may take place
;
;	NOTES:
;		- If log(g) specific runs being made, edit $outfilearr$ to distinguish restricted
;		  runs from global (~L52)
;		- Ensure filename consistency is retained between M_fileread.pro (~L52) and
;		  ../POST/mdf_plot.pro (~L90,105)for runs inducing multiple MDF plot
;
; = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = 
; = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = 
if (keyword_set(help) eq 1) then begin
   Message, 'Usage:',/info
   Message, 'M_fileread, arch_dir=arch_dir, sim1=sim1, sim2=sim2', /info
   Message, '	tag=tag, col1=col1,col2=col2, mag=mag, help=help', /info
   Message, 'Purpose: Read metallicity split simulation star selection filenames', /info
   Message, '         to population synthesis input file', /info
   Message, 'Input:   arch_dir = Directory source for SynCMD', /info
   Message, '	      sim1 = Simulation to be used (MUGS or MaGICC)', /info
   Message, '	      sim2 = Simulation iteration to be used (g1536 or g15784)', /info
   Message, '	      tag = SynCMD tag associated with analysis run', /info
   Message, '	      col1 = Colour #1 used within CMD analysis', /info
   Message, '	      col2 = Colour #2 used within CMD analysis', /info
   Message, '	      mag_glob = Magnitude scale used for CMD analysis', /info
   Message, 'Outputs: Star particle filename allocated to population', /info
   Message, '	      synthesis reference:', /info
   Message, '	      $arch_dir$/Code/Input_ListFilesNbodyStarParticles_Num_Loc.dat', /info
   return
endif
;
;		
	; - - - VARIABLE DEFINITIONS - - - ;
;
	hist_num_vec=abs((hist_up-hist_down)/hist_int)
	hist_num=hist_num(0)
;
	; - - - MAIN  PROGRAM - - - ;
;
;
infilearr=strarr(hist_num)
outfilearr=strarr(hist_num)
;
for i=0, hist_num-1 do begin
j=i+1
	infilearr(i)='../Inputs/MDF/MDFCMD_'+sim1+sim2+'_'+tag+'_'+strcompress((i+1),/remove_all)+'.dat'
	outfilearr(i)='../Outputs/CMDOut/MDF/'+col1+col2+'_'+mag_glob+'_MDFCMD'+sim1+sim2+'_'+tag+'_'+strcompress((i+1),/remove_all)
endfor

filename=arch_dir+'Code/Input_ListFilesNbodyStarParticles_Num_Loc.dat'
openw,lun,filename,/get_lun, width=35
printf,lun, hist_num
printf, lun, infilearr
free_lun, lun
;
filename=arch_dir+'Code/Ouput_NomefilesCMDgrilled.dat'
openw,lun,filename,/get_lun
printf,lun,hist_num
printf,lun, outfilearr
free_lun, lun
;
end
